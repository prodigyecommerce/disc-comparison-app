<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Google Sheets</title>
</head>
<body>
    <h1>Debug Google Sheets Access</h1>
    <div id="output"></div>
    
    <script>
        const SPREADSHEET_ID = '1Yy9KB1YjXXNLOD1w_ySlFp452UXID29J8zN9aeszp9E';
        
        async function testSheetAccess() {
            const output = document.getElementById('output');
            
            try {
                // Test Sheet1 (PDGA - should be GID 0)
                console.log('Testing Sheet1 (PDGA)...');
                const sheet1Url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=0`;
                const response1 = await fetch(sheet1Url);
                
                if (response1.ok) {
                    const csvText1 = await response1.text();
                    output.innerHTML += `<h2>Sheet1 (GID=0) - SUCCESS</h2><pre>${csvText1.substring(0, 500)}...</pre>`;
                } else {
                    output.innerHTML += `<h2>Sheet1 (GID=0) - FAILED</h2><p>Status: ${response1.status}</p>`;
                }
                
                // Test Sheet2 (Prodigy - try different GIDs)
                for (let gid of ['1', '2', '1808693328', '0']) {
                    console.log(`Testing Sheet2 with GID=${gid}...`);
                    const sheet2Url = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=${gid}`;
                    const response2 = await fetch(sheet2Url);
                    
                    if (response2.ok) {
                        const csvText2 = await response2.text();
                        output.innerHTML += `<h2>Sheet2 (GID=${gid}) - SUCCESS</h2><pre>${csvText2.substring(0, 500)}...</pre>`;
                        break; // Stop on first success
                    } else {
                        const errorText = await response2.text();
                        output.innerHTML += `<h2>Sheet2 (GID=${gid}) - FAILED</h2><p>Status: ${response2.status}</p><p>Error: ${errorText.substring(0, 200)}</p>`;
                    }
                }
                
            } catch (error) {
                output.innerHTML += `<h2>ERROR</h2><p>${error.message}</p>`;
            }
        }
        
        testSheetAccess();
    </script>
</body>
</html>